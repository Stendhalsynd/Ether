# TASK.md

## 1. 작업 우선순위
- P0: 게임 동작을 깨지 않게 하는 핵심 루프·데이터 정합성
- P1: 메인 플롯/서사 시스템 핵심 연결
- P2: 운영 확장 및 밸런스 고도화

## 2. 구현 Workstreams

### EP1. 코어 루프
- T1 [P0] `Run Engine` 엔드투엔드 파이프라인 구현  
  - 네피아 진입, 탐험 이벤트 생성, 귀환, 연대기 기록
- T2 [P0] 위험/보상 공통 스택 정합성 정리  
  - 에테르 노출, 감염 진행, 정화/오염 보정 구조 통합
- T3 [P1] 스테이지 템플릿 5종 설계  
  - 초반 생존형/중반 정보형/후반 선택형 구간 분리

### EP2. 스토리/캐릭터
- T4 [P1] 프롤로그-초기-중기-엔드 전이 조건 정의
- T5 [P1] 로미아스/라네이레/사이모어/세비리스 상태 기계 구현  
  - 협력/불신/적대/거래 상태, 신뢰도 변동
- T6 [P1] 라네이레 진실 해석 단계 업데이트 규칙(증거 기반)
- T7 [P1] 엔드 파트 엔딩 분기 최소 4개 구현(계약 재작성 방식 포함)

### EP3. 절차적 서사 모듈
- T8 [P0] 사건 모듈 스키마 및 생성기
- T9 [P1] 사건 결과 → 증거 보드 반영 규칙 엔진
- T10 [P1] 선택 기록 기반 이벤트 가중치 반영 규칙
- T11 [P1] 시즌/펙트별 메타 보정 규칙

### EP4. UI/지원 시스템
- T12 [P0] 연대기 자동 요약(Chronicle) 생성기
- T13 [P1] 증거 보드(Proof Board) 탐색/필터/연결 UI
- T14 [P1] 풍석 예고(Season Forecast) UX
- T15 [P1] 모바일 핵심 HUD: 오염·정화·신뢰도/정보 신호

### EP5. 시즌 운영
- T16 [P1] 39일 시즌 상태 머신 구현
- T17 [P1] 시즌별 네피아 변형 세트 로더
- T18 [P1] 길드 협동 과제와 시즌 보스 연동
- T19 [P2] 시즌 보고서/배포 노트 자동 초안 생성

### EP6. 계측/밸런스
- T20 [P1] 핵심 지표 대시보드: 재진입율, 진실 해석 완료율, 시즌 복귀율
- T21 [P2] 난이도 적응 규칙(초심자 안정형, 숙련자 가속형)
- T22 [P1] 다국어 텍스트 파이프라인(최초 한국어 고정)

## 3. 산출물 규격
- 각 작업 종료 시:  
  - 변경 범위 요약  
  - 반영된 인터페이스 목록  
  - 검증 시나리오(정의된 테스트 항목 1개 이상)  
- P0 완료 기준: 기능 실행 실패 없이 런 완료/재접속/저장복구 가능

## 4. 에이전트 할당(초안)
- frontend-agent
  - T12, T13, T14, T15
- backend-agent
  - T1, T2, T3, T8, T9, T10, T11, T16, T17, T18, T19
- planner-agent
  - T4, T5, T6, T7
- qe-agent
  - S1, S2, S3, S4, S5 (검증 시나리오 실행)
- validator-agent
  - T20, T21, T22 및 `PLAN.md` 승인 기준 체크

## 5. Sprint별 Ralph 게이트

### Sprint 1 게이트
- 완료 조건:
  - `T1, T2, T4, T5, T12, T13, S1, S2` 상태 `done`
  - 코어 인터페이스/시작 시나리오 문서 동기화 완료

### Sprint 2 게이트
- 완료 조건:
  - `T3, T6, T7, T8, T9, T14, T15, S3, S4` 상태 `done`
  - 중반 콘텐츠 트리거와 UI 계약 동기화 완료

### Sprint 3 게이트
- 완료 조건:
  - `T10, T11, T16, T17, T18, S5` 상태 `done`
  - 시즌 상태 머신 가동 흔적 로그 확보

### Sprint 4 게이트
- 완료 조건:
  - 전체 UI/백엔드 안정화 항목 상태 `done`
  - P0 잔여 항목 0건
  - blocked 항목 0건
  - `PLAN.md` 승인 기준 항목 모두 충족 처리

### Sprint 5 게이트
- 완료 조건:
  - 라이브 배포 게이트/롤백 규칙 문서(`SPRINT5_TASK_PACKAGES.md`) 완성
  - 시즌2 운영 템플릿 및 알림 UX 문서 정합성 완료
  - 라이브 회귀 24h/동시성 시나리오 기본안 작성
  - 운영 KPI 임계값(재진입율/재탈락율/이벤트 재참여율) 정의 완료
  - `blocked` 항목 0건 또는 처리 계획 확정
